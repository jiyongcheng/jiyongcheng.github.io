[{"categories":null,"contents":"This talk looked at Liberty Mutual’s transformation to Continuous Integration, Continuous Delivery, and DevOps. For a large, heavily regulated industry, this task can not only be daunting, but viewed by many as impossible. Often, organizations try to reduce the friction through micro-fixes, but Eddie’s team asked how to change the culture to reduce the friction and concluded with the following final points:\n Don’t mandate DevOps. Give employees the chance to master their discipline with examples to set and follow. Favor deep end-to-end accomplishments over broad but incremental steps forward. Focus on taking the right teams far before encouraging broad adoption. Centralize the platforms and tools that your teams shouldn’t be thinking about. Provide foundational services/commodities and let teams stay on purpose. Incorporate contributions from everyone; don’t stifle autonomy. Stay open to new ways of working. Challenge security policies, but respect intentions. Find new ways to enforce concerns without abandoning precaution.    ","permalink":"https://jiyongcheng.dev/publications/alldaydevops/","tags":["DevOps","Continuous Integration","Continuous Delivery","CI/CD pipelines","agile","Culture"],"title":"Organically DevOps: Building Quality and Security into the Software Supply Chain at Liberty Mutual"},{"categories":["Web Development"],"contents":"Laravel provides several built-in user providers for authentication, including Eloquent and Database providers. However, sometimes you may want to use a custom data source or storage for user authentication. In such cases, you can create a custom user provider in Laravel.\nFor my case, our client has already had hash algorithm and function to work, I\u0026rsquo;m thinking how to use Laravel 9 to do same thing.\nSo in this tutorial, we will walk you through the steps of creating a custom user provider in Laravel.\nPrerequisites Before we get started, make sure you have the following:\n Laravel installed on your machine A database setup for your Laravel application  Step 1: Create the User Model The first step is to create a User model that extends the Illuminate\\Database\\Eloquent\\Model class and implement the Illuminate\\Contracts\\Auth\\Authenticatable interface. This model will be used to retrieve user information from the database.\n\u0026lt;?php namespace App\\Models; use Illuminate\\Database\\Eloquent\\Factories\\HasFactory; use Illuminate\\Foundation\\Auth\\User as Authenticatable; class Admin extends Authenticatable { use HasFactory; public $table=\u0026#39;cms_adminaccount\u0026#39;; protected $primaryKey = \u0026#39;uid\u0026#39;; public $timestamps = false; public $fillable = [\u0026#39;username\u0026#39;, \u0026#39;email\u0026#39;, \u0026#39;password\u0026#39;]; } Step 2: Create the User Provider The next step is to create a custom user provider that will handle user authentication. You can create a user provider using the make:provider Artisan command:\nphp artisan make:provider AdminUserProvider This command will create a new file called AdminUserProvider.php in the app/Providers directory. Because we want to use Eloquent to fetch user from DB, but just change how it validates the password. So we extend the class EloquentUserProvider\n\u0026lt;?php namespace App\\Providers; use Illuminate\\Auth\\EloquentUserProvider; use Illuminate\\Contracts\\Auth\\Authenticatable as UserContract; class AdminUserProvider extends EloquentUserProvider { /** * Validate a user against the given credentials. * * @param \\Illuminate\\Contracts\\Auth\\Authenticatable $user * @param array $credentials * @return bool */ public function validateCredentials(UserContract $user, array $credentials): bool { if (is_null($plain = $credentials[\u0026#39;password\u0026#39;])) { return false; } return $this-\u0026gt;hasher-\u0026gt;check($plain, $user-\u0026gt;getAuthPassword(), [\u0026#39;salt\u0026#39; =\u0026gt; $user-\u0026gt;salt]); } } The retrieveById method in the parent class should retrieve a user by their unique identifier, which is typically the user ID. But pay attention to some DB design may choose for example uid as the primary key. So then you need to add protected $primaryKey = 'uid'; in your User model.\nThe retrieveByCredentials method in the parent class should retrieve a user by their credentials (e.g., email and password).\nThe validateCredentials method should validate the user\u0026rsquo;s credentials. This is the methond we want to extend and put in our logic.\nStep 3: Register the User Provider After creating the custom user provider, you need to register it with Laravel. To do this, open the config/auth.php file and add your provider to the providers array:\n\u0026#39;providers\u0026#39; =\u0026gt; [ \u0026#39;users\u0026#39; =\u0026gt; [ \u0026#39;driver\u0026#39; =\u0026gt; \u0026#39;eloquent\u0026#39;, \u0026#39;model\u0026#39; =\u0026gt; App\\Models\\User::class, ], \u0026#39;admin_provider\u0026#39; =\u0026gt; [ \u0026#39;driver\u0026#39; =\u0026gt; \u0026#39;admin_provider_driver\u0026#39;, \u0026#39;model\u0026#39; =\u0026gt; App\\Models\\Admin::class, ], ], In this example, we\u0026rsquo;ve added a new provider named admins and set its driver to admin_driver. The model key specifies the custom user model that we created in Step 1.\nNote that you can choose any name for your provider and driver. It\u0026rsquo;s common to name them after your application or the type of user they represent.\nStep 4: Register the custom guard Define your guard in the guards array of the config/auth.php file. We want to use the admin guard to authenticate admin users.\n\u0026#39;guards\u0026#39; =\u0026gt; [ \u0026#39;admin\u0026#39; =\u0026gt; [ \u0026#39;driver\u0026#39; =\u0026gt; \u0026#39;session\u0026#39;, \u0026#39;provider\u0026#39; =\u0026gt; \u0026#39;admin_provider\u0026#39;, ] ], Step 5: Register custom provider in AuthServiceProvider In the boot method of the AuthServiceProvider, register the custom user provider using the Auth facade:\npublic function boot() { $this-\u0026gt;registerPolicies(); // add custom guard provider  Auth::provider(\u0026#39;admin_provider_driver\u0026#39;, function ($app, array $config) { return new AdminUserProvider(new SimpleHasher(), $config[\u0026#39;model\u0026#39;]); }); } This code registers a new user provider named admin_provider_driver that uses the AdminUserProvider class. The second parameter passed to the AdminUserProvider constructor is the user model class, which is defined in the config/auth.php file.\nThe first parameter passed to the AdminUserProvider constructor is the custom hasher we created for checking user password.\nStep 6: Create custom hasher Because we just want to use the custom hasher for admin user, then we put this hasher in the services folder:\n\u0026lt;?php namespace App\\Services; use Illuminate\\Contracts\\Hashing\\Hasher; use Illuminate\\Hashing\\AbstractHasher; class SimpleHasher extends AbstractHasher implements Hasher { public function make($value, array $options = []) { $salt = substr(uniqid(rand()), -6); return md5(md5($value) . $salt); } public function check($value, $hashedValue, array $options = []) { return md5(md5($value) . $options[\u0026#39;salt\u0026#39;] ?? \u0026#39;\u0026#39;) === $hashedValue; } public function needsRehash($hashedValue, array $options = []) { // Your needsRehash implementation here  } } in our case we need to use extra info in the $options array to check the password, so this is why we extend EloquentUserProvider to have our custom AdminUserProvider which in the validateCredentials function passes the extra info for checking.\nStep 7: Create admin authenticate middleware to guard admin \u0026lt;?php namespace App\\Http\\Middleware; use Closure; use Illuminate\\Support\\Facades\\Auth; class AdminAuthenticate { public function handle($request, Closure $next) { if (Auth::guard(\u0026#39;admin\u0026#39;)-\u0026gt;check()) { return $next($request); } else { return redirect()-\u0026gt;route(\u0026#39;admin.login\u0026#39;); } } } You then need to register this middle in the Kernel.php\n\u0026lt;?php namespace App\\Http; use Illuminate\\Foundation\\Http\\Kernel as HttpKernel; class Kernel extends HttpKernel { protected $routeMiddleware = [ \u0026#39;admin.auth\u0026#39; =\u0026gt; \\App\\Http\\Middleware\\AdminAuthenticate::class, ]; } Step 8: Set admin authenticate middleware in the controller You could add admin.auth middleware for this controller or add in the routes for a group of controllers.\n\u0026lt;?php namespace App\\Http\\Controllers\\Admin; use App\\Http\\Controllers\\Controller; use Illuminate\\Support\\Facades\\Auth; use function view; class HomeController extends Controller { /** * Create a new controller instance. * * @return void */ public function __construct() { $this-\u0026gt;middleware(\u0026#39;admin.auth\u0026#39;); } } Step 9: Authenticate admin user You can use Auth::guard('admin')-\u0026gt;attempt to login admin user now.\npublic function login() { if (request()-\u0026gt;method() == \u0026#39;POST\u0026#39;) { // validation  $credentials = request()-\u0026gt;only(\u0026#39;username\u0026#39;, \u0026#39;password\u0026#39;); if (Auth::guard(\u0026#39;admin\u0026#39;)-\u0026gt;attempt($credentials)) { return redirect()-\u0026gt;route(\u0026#39;admin.index\u0026#39;); } else { return redirect()-\u0026gt;back()-\u0026gt;withErrors([ \u0026#39;email\u0026#39; =\u0026gt; \u0026#39;Invalid credentials\u0026#39;, ]); } } return view(\u0026#39;admin.login\u0026#39;); } Conclusion Creating a custom user provider in Laravel is a simple process that allows you to customize the way that users are authenticated in your application. By following the steps outlined in this article, you can create a custom user provider that uses a slight different way to validate password.\n","permalink":"https://jiyongcheng.dev/post/2023/how-to-create-a-custom-user-provider-in-laravel-9/","tags":["Laravel 9","PHP"],"title":"How to create a custom user provider in Laravel 9"},{"categories":["Web Development"],"contents":"I spent a bit of time to understand how Xdebug3.1.6 work in PHP8.1, the following is the UML sequence diagram for my understanding of Xdebug. Some notes   In a Docker container, you need to tell Xdebug where to make the debugging connection to, as it is Xdebug that initiates the communication to the IDE, and not the other way around.\n  If we set xdebug.start_with_request=yes in 99-xdebug.ini, every request will trigger a debugging session.\n  Set this in docker-compose.yml environment PHP_IDE_CONFIG=\u0026quot;serverName=servername.local\u0026quot; and then export in the container for once.\n  export PHP_IDE_CONFIG=\u0026#34;serverName=servername.local\u0026#34;.  Set xdebug.log=/tmp/xdebug.log in the 99-xdebug.ini, you can always check the log info to know what\u0026rsquo;s going on for the xdebug, go to container run cat /tmp/xdebug.log  ","permalink":"https://jiyongcheng.dev/post/2023/xdebug/","tags":["Xdebug","PHP"],"title":"Xdebug"},{"categories":["tool"],"contents":"Column selection Column selection can be used to select a rectangular area of a file.\nMac Using mouse Left Mouse Button + ⌥ OR: Middle Mouse Button Add to selection: ⌘ Subtract from selection: ⇧+⌘  Using keyboard Ctrl+Shift+⬆ Ctrl+Shift+⬇  ","permalink":"https://jiyongcheng.dev/post/sublime/","tags":["sublime","tool"],"title":"Sublime"},{"categories":["Programming"],"contents":"For the general programming knowledge.\nOff-By-One [溢出]  严格来说，off-by-one是一种特殊的溢出漏洞，off-by-one指程序向缓冲区中写入时，写入的字节数超过了这个缓冲区本身所申请的字节数并且只越界了一个字节。 off-by-one，是指单字节缓冲区溢出，这种漏洞的产生往往与边界验证不严和字符串操作有关，也不排除写入的size正好就只多了一个字节的情况。 一般认为，单字节溢出是难以利用的，但是因为Linux的堆管理机制ptmalloc验证的松散性，基于Linux堆的off-by-one漏洞利用起来并不复杂，并且威力强大。 off-by-one是可以基于各种缓冲区的，比如栈、bss段等等，但是堆上（heap based）的off-by-one是CTF中比较常见的。 ","permalink":"https://jiyongcheng.dev/post/general/","tags":["programming"],"title":"General"},{"categories":["DB"],"contents":"I try to list out the questions during working on Postgresql here for the future reference.\nHow to convert date string to timestamp in postgresql? Use function TO_TIMESTAMP\nSELECT TO_TIMESTAMP(\u0026#39;2017-03-31 9:30:20\u0026#39;,\u0026#39;YYYY-MM-DD HH:MI:SS\u0026#39;); -- it will return as following: 2017-03-31 09:30:20.000000 How to return a string value from jsonb in Postgresql? Use jsonb-\u0026gt;\u0026gt;key operator, be carefuly if you use jsonb-\u0026gt;key it will return back jsonb type, not a string.\nselect \u0026#39;{ \u0026#34;first_name\u0026#34;: \u0026#34;Adam\u0026#34;, \u0026#34;last_name\u0026#34;: \u0026#34;Smith\u0026#34;, \u0026#34;created_at\u0026#34;: \u0026#34;2021-12-07 03:08:57\u0026#34;, \u0026#34;updated_at\u0026#34;: \u0026#34;2021-12-07 03:09:00\u0026#34; }\u0026#39;::jsonb-\u0026gt;\u0026gt;\u0026#39;first_name\u0026#39;; -- it will return `Adam` Can I extract the info from jsonb in postgresql? jsonb_extract_path ( from_json jsonb, VARIADIC path_elems text[] ) → jsonb\nExtracts JSON sub-object at the specified path. (This is functionally equivalent to the #\u0026gt; operator, but writing the path out as a variadic list can be more convenient in some cases.)\njson_extract_path(\u0026#39;{\u0026#34;f2\u0026#34;:{\u0026#34;f3\u0026#34;:1},\u0026#34;f4\u0026#34;:{\u0026#34;f5\u0026#34;:99,\u0026#34;f6\u0026#34;:\u0026#34;foo\u0026#34;}}\u0026#39;, \u0026#39;f4\u0026#39;, \u0026#39;f6\u0026#39;) → \u0026#34;foo\u0026#34; How to put log in stored procedures? You need to change the config file postgresql.conf and set log_min_messages = notice, there are some options you can choose, check the config file.\nIS NOT NULL work with composite type data If you have a value something that is a composite type, for example a row of a table, something IS NOT NULL is only true if none of the attributes of the composite are NULL. check more details here\nHow to save 24hours time format if you see some error like this Postgresql ERROR: hour \u0026quot;16\u0026quot; is invalid for the 12-hour clock you could do this TO_TIMESTAMP(i_test_date -\u0026gt;\u0026gt; 'created_at', 'YYYY-MM-DD HH24:MI:SS') to save the time as 24hours format\n","permalink":"https://jiyongcheng.dev/post/postgresql-questions/","tags":["Postgresql"],"title":"Postgresql Questions"},{"categories":["DevOps"],"contents":"Git commands list some commands often being used:\nDelete branch  Deleting local branches  git branch -d feature/add-new-feature  Deleting remote branches in Git  git push origin --delete feature/add-new-feature Change branch name  change name of local branch  git checkout \u0026lt;branch\u0026gt; git branch -m \u0026lt;new_branch_name\u0026gt; ##example git checkout feature git branch -m quickfix  change name of remote branch  you have to change branch name locally first then do the following:    git push \u0026lt;remote\u0026gt; :\u0026lt;old_branch_name\u0026gt; \u0026lt;new_branch_name\u0026gt; #you have to set the upstream branch for the newly created branch using the “git upstream” command. git push \u0026lt;remote\u0026gt; -u \u0026lt;new_branch_name\u0026gt; git push origin :feature quickfix git push origin -u quickfix ## example ","permalink":"https://jiyongcheng.dev/post/git-command/","tags":["Git"],"title":"Git Commands"},{"categories":["DB"],"contents":"Is it possible to convert SQLite to MySQL \u0026ldquo;as is\u0026rdquo;? Probably the quick and easiest way to convert SQLite to MySQL includes two general steps:\n Export SQLite database to dump file using SQLite .dump command.  sqlite3 sample.db .dump \u0026gt; dump.sql  You can then (in theory) import SQLite dump into the MySQL database.  mysql -p -u root -h 127.0.0.1 test \u0026lt; dump.sql \u0026ldquo;In theory\u0026rdquo; means that solution wouldn\u0026rsquo;t work as there are a few differences in grammars between MySQL and SQLite.\nThere are just some differences between SQLite and MySQL syntax\n   SQLite MySQL     AUTOINCREMENT AUTO_INCREMENT   TEXT varchars   double quotes (\u0026quot; \u0026ldquo;) backticks (` `)   BEGIN TRANSACTION; COMMIT;  BEGIN; COMMIT   CLOB TINYTEXT, TEXT, MEDIUMTEXT, LONGTEXT   PRAGMA foreign_keys=OFF; SET FOREIGN_KEY_CHECKS=0;   ","permalink":"https://jiyongcheng.dev/post/convert-sqlite-to-mysql/","tags":["sqlite","mysql"],"title":"Convert Sqlite to Mysql"},{"categories":["system-design"],"contents":"In the LNMP development process, we often configure the nginx, and we will set similar like this\nupstream php-fpm { server php-fpm:9000; } and I want to know what does upstream here mean.\nSo basically it\u0026rsquo;s about dependency, the Nginx server depend on PHP server to return back data. So PHP server is upstream of Nginx.\nThe Browser is depending on the Nginx server to return back data, so Nginx server is upstream of Browser.\nOn the other hand, Browser is downstream of Nginx server, because the data from Nginx will flow into the Browser, same as PHP, DB.\n A production process is very similar to a river, so it’s easy to grasp that as the process goes from one step to the next, we’re moving downstream.\n  We can deduct the following rules:\n Dependency Rule: each item depends on all the items upstream from its viewpoint Value Rule: moving downstream, each step adds more value to the product  ","permalink":"https://jiyongcheng.dev/post/upstream-downstream/","tags":["upstream"],"title":"Upstream and Downstream"},{"categories":["DevOps"],"contents":"Does Docker build \u0026ndash;no-cache actually download and refresh the base image The \u0026ndash;no-cache option will rebuild the image without using the local cached layers.\nHowever, the FROM line will reuse the already pulled base image if it exists on the build host (the from line itself may not be cached, but the image it pulls is).\nIf you want to pull the base image again, you can use the \u0026ndash;pull option to the build command. E.g.\ndocker build --no-cache --pull -t new-image-name:latest .\ncheck more from here\n","permalink":"https://jiyongcheng.dev/post/docker-commands/","tags":["docker"],"title":"Docker commands"},{"categories":null,"contents":"Architecture and Infrastructure Software architecture  Software architecture patterns search #softwarearchitecture on youtube c4 Model https://c4model.com/ DDD https://github.com/heynickc/awesome-ddd example about hexagonal architecture.  https://www.youtube.com/watch?v=ujb_O6myknY https://github.com/tedyoung/kid-bank https://www.twitch.tv/videos/663668992 related to hexagonal architecture: https://www.jianshu.com/p/c2a361c2406c   architecture decision record: https://adr.github.io/ archunit is a java tool to help enforcing architecture, for php there is one as well https://github.com/j6s/phparch 凤凰架构-构筑可靠的大型分布式系统 explicit architecture https://github.com/hgraca/explicit-architecture-php  System Design  https://www.stephanboyer.com/post/132/what-are-covariance-and-contravariance https://www.cloudsavvyit.com/9904/what-is-covariance-and-contravariance-in-programming/  Computer system  A gentle introduction to computer systems https://diveintosystems.org/book/index.html  AWS  https://app.cloudcraft.co/blueprint/23df5228-15cf-4521-bf0b-5e9da066c29c Draw AWS diagram https://expeditedsecurity.com/aws-in-plain-english/  Salt  https://github.com/hbokh/awesome-saltstack  Data structure and algorithm Algorithm  https://github.com/williamfiset/Algorithms  Practice  https://github.com/karan/Projects  Database PostgreSQL  https://github.com/faisalbasra/postgres_books  Mysql  deadlocks https://github.com/aneasystone/mysql-deadlocks  DevOps makefile  Makefile: https://makefiletutorial.com/#getting-started  git  https://www.git-scm.com/book/en/v2 https://www.atlassian.com/git/tutorials/what-is-version-control  Programming languages Tools for programming languages  https://programming-idioms.org/about#about-block-all-idioms  Java  https://programmingbydoing.com/ java-a-beginners-guide-eighth-edition: https://pdfroom.com/books/java-a-beginners-guide-eighth-edition/PXn2GJrKgxV  Python  https://realpython.com/ https://au1lib.org/book/5973705/f707f1?id=5973705\u0026amp;secret=f707f1 books for download free books :https://github.com/pamoroso/free-python-books  PHP  https://github.com/jiyongcheng/awesome-php https://github.com/codeguy/php-the-right-way Design pattern https://github.com/DesignPatternsPHP/DesignPatternsPHP https://github.com/PatrickLouys/professional-php-sample-code  Framework  Simovative PRG-HTTP-Framework https://github.com/Simovative/zeus https://github.com/microinginer/yii2-dropdown-action-column Symfony 4 https://github.com/eko/docker-symfony Magento 1.9 https://github.com/andreaskoch/dockerized-magento  Javascript  Javascript https://masteringjs.io/fundamentals  GoLang    https://github.com/unknwon/the-way-to-go_ZH_CN    Web Development Frontend  https://github.com/jiyongcheng/fks https://github.com/grab/front-end-guide  HTML  HTML head element explaination https://github.com/joshbuchea/HEAD Every element I use for the basic structure of a HTML document https://www.matuzo.at/blog/html-boilerplate/ CORS https://jakearchibald.com/2021/cors/  CSS  Google learn css course: https://web.dev/learn/css/  Icon  icon free download: https://iconic.app/ https://openmoji.org/ list of websites with icons that are free for commercial use: https://www.websiteplanet.com/blog/free-icons-for-commercial-use/  Jquery  https://github.com/hayageek/jquery-upload-file  React  https://github.com/jiyongcheng/react-collection https://github.com/wellyshen/react-cool-starter  Tools shortcut https://www.shortcutfoo.com/ Books  https://github.com/stormtrooper96/books https://github.com/AB1908/CS-Books  Miscellaneous Uncategorised  https://joelcalifa.com/work/ https://github.com/laradock/laradock https://github.com/google/eng-practices  Blog  https://github.com/hawx1993/tech-blog https://github.com/mqyqingfeng/Blog https://github.com/singpenguin/ppt  Magazine  https://github.com/rogerzhu/MNWeeklyCategory  Interview  https://github.com/monklof/Back-End-Developer-Interview-Questions https://github.com/sharu725/online-cv https://github.com/yangshun/front-end-interview-handbook  Courses  https://github.com/prakhar1989/awesome-courses computer science https://github.com/1c7/Crash-Course-Computer-Science-Chinese  Math  https://mathlets.org/mathlets/  ","permalink":"https://jiyongcheng.dev/resource/","tags":null,"title":""},{"categories":["DevOps"],"contents":"lsof list open files\nlsof -i -P -n | grep LISTEN - -i selects the listing of all Internet and x.25 (HP-UX) network files - -P inhibit the conversion of port numbers to port names - -n inhibit the conversion of network numbers to host names -P and -n will make the lookup faster\nExample List only files that listen to port 80 lsof -i:80 -P -n | grep LISTEN\n","permalink":"https://jiyongcheng.dev/post/check-port-being-used/","tags":["linux","lsof"],"title":"Check Port Being Used"},{"categories":["DevOps"],"contents":"What does 10064 mean in Git? When you do git commit command, you probably have seen this information\ndelete mode 100644 layouts/resource/index.html create mode 100644 layouts/resource/section.html but what does this series of number mean?\nThe values shown are the 16-bit file modes as stored by Git, you can check here to know more:\n32-bit mode, split into (high to low bits) 4-bit object type valid values in binary are 1000 (regular file), 1010 (symbolic link) and 1110 (gitlink) 3-bit unused 9-bit unix permission. Only 0755 and 0644 are valid for regular files. Symbolic links and gitlinks have value 0 in this field. If the file doesn’t mention directories; they are represented using object type 0100.\nEach digit in the six-digit value is in octal, representing three bits; 16 bits thus need six digits, the first of which only represents one bit:\nType|---|Perm bits 1000 000 111101101 1 0 0 7 5 5 1000 000 110100100 1 0 0 6 4 4 Git doesn’t store arbitrary modes, only a subset of the values are allowed, from the usual POSIX types and modes (in octal, 12 for a symbolic link, 10 for a regular file, 04 for a directory) to which git adds 16 for Git links. The mode is appended, using four octal digits.\nFor files,\nyou’ll only ever see 100755 or 100644 (although 100664 is also technically possible);\ndirectories are 040000 (permissions are ignored),\nsymbolic links 120000.\nThe set-user-ID, set-group-ID and sticky bits aren’t supported at all (they would be stored in the unused bits).\n","permalink":"https://jiyongcheng.dev/post/understanding-git/","tags":["git"],"title":"Understanding Git"},{"categories":["DevOps"],"contents":"Problem We have a list of IDs generated into a file F with this format:\n2f9921bc-a4c9-419a-b069-f8f23c7727f7 26bf5cc3-73de-425e-9a6b-b70223387314 30ac5b4c-f4c6-42c6-901d-e8bdf16464b8 We want to generate a JSON object from the IDs with this structure:\n{ \u0026#34;users\u0026#34;: [ { \u0026#34;user_id\u0026#34;: \u0026#34;2f9921bc-a4c9-419a-b069-f8f23c7727f7\u0026#34; } ], \u0026#34;organisation_id\u0026#34;: 123, \u0026#34;user-type\u0026#34;: \u0026#34;test\u0026#34; } The way we do it we use jq  what is jq  jq is a lightweight and flexible command-line JSON processor. 轻量级的命令行JSON处理器，非常灵活   what are the main features  jq is like sed for JSON data  你可以方便的使用它对结构化的数据进行slice and filter and map and transform   jq is written in portable C, and it has zero runtime dependencies.  它没有运行时的依赖     Tutorial Manual or you can run man jq  How do we do it the following is the code\nUSER_IDS=$(jq -Rn \u0026#39; def assemble_user($user_id): { \u0026#34;user_id\u0026#34;: $user_id }; [ inputs | select(length\u0026gt;0) | assemble_user(.) ]\u0026#39; \u0026lt;\u0026lt;\u0026lt; \u0026#34;$USER_IDS\u0026#34;) USER_JSON=$( jq -n \\  --argjson user_ids \u0026#34;$USER_IDS\u0026#34; \\  --arg organisation_id \u0026#34;$ORGANISATION_ID\u0026#34; \\  --arg user_type \u0026#34;$USER_TYPE\u0026#34; \\  \u0026#39;{organisation_id: $organisation_id, user_type: $user_type, users: $user_ids}\u0026#39; ) echo \u0026#34;$USER_JSON\u0026#34; Syntax of jq   \u0026ndash;raw-input/-R: Don\u0026rsquo;t parse the input as JSON. Instead, each line of text is passed to the filter as a string. If combined with \u0026ndash;slurp, then the entire input is passed to the filter as a single long string.\n  \u0026ndash;null-input/-n: Don\u0026rsquo;t read any input at all! Instead, the filter is run once using null as the input. This is useful when using jq as a simple calculator or to construct JSON data from scratch.\n  input and inputs, that read from the same sources (e.g., stdin, files named on the command-line) as jq itself.\n input Outputs one new input. inputs Outputs all remaining inputs, one by one.    Explaination of the process   -R means jq will treat the anything it gets as a string not a JSON. if you don\u0026rsquo;t use -R and pass a string as input, it will throw error.\n  -n means jq will not read any input. so it can work together with inputs to construct a JSON data.\n if you do this echo '1\\n2\\n3' | jq -R '[inputs]' you will only get [\u0026quot;2\u0026quot;,\u0026quot;3\u0026quot;]. why? because without -n jq will read a input, which is 1, then the inputs will ouputs the remaining inputs, which are 2\\n3. if you do this echo '1\\n2\\n3' | jq -Rn '[inputs]', you will get [\u0026quot;1\u0026quot;,\u0026quot;2\u0026quot;,\u0026quot;3\u0026quot;]. why? because with -n jq will not read a input, so the inputs will outputs the remaining inputs, which are 1\\n2\\n3.    select(length\u0026gt;0) for each input, it will filter out the empty input\n  assemble_user(.) for each input, it will call the def assemble_user\n  def assemble_user($user_id): {\u0026quot;user_id\u0026quot;: $user_id} for each input like 123, it will return a object like {\u0026quot;user_id\u0026quot;: 123}\n  \u0026lt;\u0026lt;\u0026lt; this symbol means Here string\n \u0026lt;\u0026lt;\u0026lt; is known as here-string. Instead of typing in text, you give a pre-made string of text to a program. For example, with such program as bc we can do bc \u0026laquo;\u0026lt; 54 to just get output for that specific case, no need to run bc interactively. Think of it as the equivalent of echo \u0026lsquo;54\u0026rsquo; | bc.  check the difference between \u0026lt;,\u0026lt;\u0026lt;,\u0026lt;\u0026lt;\u0026lt; here\n  --argjson means it has a JSON data as the argument.\n  --arg means it has a string data as the argument\n  jq -n --argjson user_ids \u0026quot;$USER_IDS\u0026quot; --arg organisation_id \u0026quot;$ORGANISATION_ID\u0026quot;  you can structure a JSON data easily.\n  The result  So first step I get the array with objects.  if you do this quickly    echo \u0026#39;2f9921bc-a4c9-419a-b069-f8f23c7727f7\\n26bf5cc3-73de-425e-9a6b-b70223387314\\n30ac5b4c-f4c6-42c6-901d-e8bdf16464b8\u0026#39; | jq -Rn \u0026#39; def assemble_users($user_id): {\u0026#34;user_id\u0026#34;: $user_id}; [ inputs | select(length\u0026gt;0) | assemble_users(.) ]\u0026#39; you will get:\n[ { \u0026#34;user_id\u0026#34;: \u0026#34;2f9921bc-a4c9-419a-b069-f8f23c7727f7\u0026#34; }, { \u0026#34;user_id\u0026#34;: \u0026#34;26bf5cc3-73de-425e-9a6b-b70223387314\u0026#34; }, { \u0026#34;user_id\u0026#34;: \u0026#34;30ac5b4c-f4c6-42c6-901d-e8bdf16464b8\u0026#34; } ]  Second, I assemble them together as a object. you will get  { \u0026#34;users\u0026#34;: [ { \u0026#34;user_id\u0026#34;: \u0026#34;2f9921bc-a4c9-419a-b069-f8f23c7727f7\u0026#34; }, { \u0026#34;user_id\u0026#34;: \u0026#34;26bf5cc3-73de-425e-9a6b-b70223387314\u0026#34; }, { \u0026#34;user_id\u0026#34;: \u0026#34;30ac5b4c-f4c6-42c6-901d-e8bdf16464b8\u0026#34; } ], \u0026#34;organisation_id\u0026#34;: 123, \u0026#34;user-type\u0026#34;: \u0026#34;test\u0026#34; } ","permalink":"https://jiyongcheng.dev/post/create-array-with-object-from-list/","tags":["jq"],"title":"Create Array With Object From List using jq"},{"categories":["Programming Language"],"contents":"The question I have I was reading this article \u0026ldquo;PHP Serialization, Stack Traces, and Exceptions\u0026rdquo;[^1] and had these questions:\n Why PDO isn\u0026rsquo;t serializable? Why isn\u0026rsquo;t every type of object serializable?  The answer After some search, I found some useful information as follows. check this for details\n A PDO object contains state that cannot be represented in the serialization format. For example, the PDO object contains an open connection to a database server.\n And I copied the answer from here:\nSome objects encapsulate resources like file pointers or network sockets that can\u0026rsquo;t be deserialized to the state they were in when you serialized the object that contained them.\nExample: you shouldn't deserialize an object that serves as an authenticated database connection, because to do so, you'd need the serialized form to contain a plaintext password. This would not be a good practice, because someone might get a hold of the saved serialized form. You also have no idea when you deserialize that the database server is still running, can be accessed, the authentication credentials still valid, etc.  Why the test written by the author can work Test code is here:\nclass NotSerializable implements Serializable { public function serialize() { throw new LogicException(\u0026#39;You cannot serialize or unserialize NotSerializable instances\u0026#39;); } public function unserialize($serialized) { throw new LogicException(\u0026#39;You cannot serialize or unserialize NotSerializable instances\u0026#39;); } } If you write a test code like this:\n$a = new NotSerializable(); echo serialize($a); It will throw the error:\nPHP Fatal error: Uncaught LogicException: You cannot serialize or unserialize NotSerializable instances in /home/jdoodle.php:7 Stack trace: #0 [internal function]: NotSerializable-\u0026gt;serialize() #1 /home/jdoodle.php(23): serialize(Object(NotSerializable)) #2 {main}  thrown in /home/jdoodle.php on line 7 Command exited with non-zero status 255 My understanding Because the serialize() function should return string or null to represent the object\u0026rsquo;s state, but it throws an Exception which isn\u0026rsquo;t it\u0026rsquo;s state. Thus in this scenario the object of class NotSerializable is not serializable even though it implements the Serializable interface.\nReference [^1] PHP Serialization, Stack Traces, and Exceptions\n","permalink":"https://jiyongcheng.dev/post/not-all-objects-serializable/","tags":["PHP","PDO","Serializable"],"title":"Not All Objects Serializable"},{"categories":["Programming Language"],"contents":"What did I see? I saw in a PHP class using this method __invoke\npublic function __invoke(int $errorNumber, string $errorString, string $errorFile, int $errorLine): bool { ... } Why using this method? This magic method is called when user tries to invoke object as a function. Possible use cases may include some approaches like functional programming or some callbacks.\nHow do people use it? class Invokable { /** * This method will be called if object will be executed like a function: * * $invokable(); * * Args will be passed as in regular method call. */ public function __invoke($arg, $arg, ...) { print_r(func_get_args()); } } // Example: $invokable = new Invokable(); $invokable([1, 2, 3]); // optputs: Array ( [0] =\u0026gt; 1 [1] =\u0026gt; 2 [2] =\u0026gt; 3 ) ","permalink":"https://jiyongcheng.dev/post/php-magic-method-invoke/","tags":["PHP","magic method"],"title":"PHP Magic Method Invoke"},{"categories":["Web Development"],"contents":"Issue found: I found the post which has code block cannot render correctly in the small devices which width is less than 576px.\nWhy? I want to understand why this happend. So I just picked up a snippet which contains the code block and put into the bootstrap 5 example. Then the render result is like this:\nMy code block looks like this:\n\u0026lt;div class=\u0026#34;highlight\u0026#34;\u0026gt; \u0026lt;pre tabindex=\u0026#34;0\u0026#34; style=\u0026#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\u0026#34;\u0026gt; \u0026lt;code class=\u0026#34;language-bash\u0026#34; data-lang=\u0026#34;bash\u0026#34;\u0026gt; \u0026lt;span\u0026gt;export ANDROID_HOME\u0026lt;/span\u0026gt;\u0026lt;span style=\u0026#34;color:#f92672\u0026#34;\u0026gt;=\u0026lt;/span\u0026gt;\u0026lt;span\u0026gt;/Users/aron/Library/Android/sdk\u0026lt;/span\u0026gt; export PATH\u0026lt;span style=\u0026#34;color:#f92672\u0026#34;\u0026gt;=\u0026lt;/span\u0026gt;$ANDROID_HOME/platform-tools:$PATH export PATH\u0026lt;span style=\u0026#34;color:#f92672\u0026#34;\u0026gt;=\u0026lt;/span\u0026gt;$ANDROID_HOME/tools:$PATH \u0026lt;/code\u0026gt; \u0026lt;/pre\u0026gt; \u0026lt;/div\u0026gt; This doesn\u0026rsquo;t have issue, So I guess my html dom may have issue, so I copied my html dom just one more level up\n\u0026lt;div class=\u0026#34;d-grid\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;highlight\u0026#34;\u0026gt; \u0026lt;pre tabindex=\u0026#34;0\u0026#34; style=\u0026#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\u0026#34;\u0026gt; ... \u0026lt;/pre\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; then the issue happens:\nSo I know the issue happen when I use class=\u0026quot;d-grid\u0026quot;, and checked again the class d-grid using this style:\n.d-grid { display: grid !important; } and class pre using this style\npre { display: block; margin-top: 0; margin-bottom: 1rem; overflow: auto; font-size: .875em; } If I tick off class d-grid display style, it will render correctly.\nHow to solve it remove the class d-grid\n","permalink":"https://jiyongcheng.dev/post/render-code-block-in-bootstrap5/","tags":["bootstrap 5","mobile"],"title":"Render Code Block in Bootstrap 5"},{"categories":["IDE"],"contents":"phpstorm Mac Keymap    shortcut description     Ctrl Option O Optimize imports   Ctrl G Next selection   Ctrl Cmd G All selection   Cmd D Duplicate code   Option Cmd L Reformat code    How to stop indexing System Settings -\u0026gt; Synchronize external changes when switching to the IDE window or opening an editor tab\n","permalink":"https://jiyongcheng.dev/post/phpstorm/","tags":["phpstorm"],"title":"Phpstorm"},{"categories":["react"],"contents":"Issue I met I want to follow this article to learn creating apps with react native. But I met several issues:\n error Failed to launch emulator. Reason: No emulators found as an output of emulator -list-avds. warn Please launch an emulator manually or connect a device. Otherwise app may fail to launch. info Installing the app\u0026hellip; Task :app:installDebug FAILED\n Then I realized the another issue prompted: /bin/sh: adb: command not found\nHow to solve After googling, I got answer:\nexport ANDROID_HOME=/Users/aron/Library/Android/sdk export PATH=$ANDROID_HOME/platform-tools:$PATH export PATH=$ANDROID_HOME/tools:$PATH and I ran it again, it works. But I think you should also have created an AVD as well.\n","permalink":"https://jiyongcheng.dev/post/android-app-with-react-native/","tags":["react","react-native"],"title":"Android app with react native"},{"categories":null,"contents":"Intro Doesn\u0026rsquo;t matter whether it\u0026rsquo;s a CakePHP app for a client, your own personal CMS, or any other web based application. If your passing around passwords or other sensitive info you should really implement SSL. SSL provides 2 main perks to your visitors.\n First it encrypts all communication that flies across the web. This prevents curious or devious billies from getting your secrets. Secondly it ensures to the user that your server is in fact who it claims, and not a nasty \u0026lsquo;man in the middle\u0026quot; attack. Finally it gives your site that touch of class\u0026hellip;. which of course a classy person like yourself relies on.  Once you implement SSL certificates on your server you\u0026rsquo;ll want to require secure connections using Apache\u0026rsquo;s rewrite module. Now I won\u0026rsquo;t dwell on the creation and signing of certificates, its already well documented. If your just starting out though,heres a few links I recommend;\n Creating self-signed certificates (free, but should only be used internally or for testing, users will; see an \u0026lsquo;Untrusted\u0026quot; warning) Requesting a CA Signed certificate (not free, but the final certificate is trusted and seamless for users)  The second link uses the schools internal CA, you will need to pay a public CA like Entrust or Verisign. All of this information is aimed at \u0026lsquo;nix or solaris servers running apache. Why? cause a production windows server is laughable :-p\nNow that you have a certificate, whats next? So there you are you have a shiny new Certificate and Server key, how do you force visitors to your apache driven site to use the SSL? You copied the certificates into the appropite locations right? And you have made the needed changes in httpd.conf right? So now when you view https://example.com you see a \u0026lsquo;trusted\u0026rsquo; warning or your site right? If No to any of these than this article does a pretty good job of outlining those steps.\nThe SSL Works, How do I force connections to use it? First you need to decide if you want to force every page on your site to use SSL, or only a particular sub-domain, or maybe just your admin directory. Since the overhead is minimal there is no harm is forcing the entire domain to leverage SSL, but if it is a self-signed certificate for your personal use than you\u0026rsquo;ll most certainly want to restrict its use to your own areas. This prevents users from seeing that nasty warning \u0026ldquo;This server is not trusted\u0026rdquo; You\u0026rsquo;ll know if your using SSL because the url prefix changes from http to https (s for secure).\nForcing entire domain to use SSL You want any visit, any where to use ssl. This probably the simplest solution. Create or append to your htaccess file in the top directory of your server. Some people use a port check (80 is typically http, while 443 is https) but if you have alernate configs or the user just adds :8080 to the end of the url this method is useless. Instead check whether the https environmental variable is set, if not then redirect.\nRewriteCond %{HTTPS} !=on RewriteRule ^(.*)$ https://%{SERVER_NAME}$1 \\[R,L\\] Forcing sub-domains to use SSL Maybe you only want mysecretarea.example.com to use SSL, that\u0026rsquo;s easy enough. Its the same premise as above, but you move the htaccess file into the directory that corresponds to the subdomain. Also change the second line like below;\nRewriteCond %{HTTPS} !=on RewriteRule ^(.*)$ https://mysecretarea.%{SERVER_NAME}$1 \\[R,L\\] Forcing a directory to use SSL This method cn get a little hairier if your using aliases or redirects on top of this one. You\u0026rsquo;ll need to consider what order the commands are read. The basic principle is like so. You want all visits to example.com/admin to use ssl. Create a htaccess file in the parent directory. Again will check for the https variable, but this time we also check for the sub-directory to be in the path.\nRewriteCond %{HTTPS} !=on RewriteRule ^/admin/(.*)$ https://%{SERVER_NAME}/admin/$1 \\[R,L\\] ","permalink":"https://jiyongcheng.dev/blog/force-ssl/","tags":["apache","apache","redirect","rewrite","ssl","web development"],"title":"Forcing Visits to use SSL"},{"categories":null,"contents":"Multiple plugins used by thousands of teams that provide enhanced functionality of Atlassian’s core products (primarily JIRA and Bamboo) to enrich CI/CD capabilities, DevOps automation, or productivity. Functionality spans user interface, web services and persistence.\n","permalink":"https://jiyongcheng.dev/projects/marketplace-copy/","tags":["Java","Spring","REST APIs","Javascript","Atlassian Developer Ecosystem","Bamboo","JIRA","Bitbucket","Confluence","DevOps"],"title":"Atlassian Marketplace Plugins"},{"categories":null,"contents":"Multiple plugins used by thousands of teams that provide enhanced functionality of Atlassian’s core products (primarily JIRA and Bamboo) to enrich CI/CD capabilities, DevOps automation, or productivity. Functionality spans user interface, web services and persistence.\n","permalink":"https://jiyongcheng.dev/projects/marketplace/","tags":["Java","Spring","REST APIs","Javascript","Atlassian Developer Ecosystem","Bamboo","JIRA","Bitbucket","Confluence","DevOps"],"title":"Atlassian Marketplace Plugins"},{"categories":null,"contents":"This file exists solely to respond to /search URL with the related search layout template.\nNo content shown here is rendered, all content is based in the template layouts/page/search.html\nSetting a very low sitemap priority will tell search engines this is not important content.\nThis implementation uses Fusejs, jquery and mark.js\nInitial setup Search depends on additional output content type of JSON in config.toml\n[outputs] home = [\u0026#34;HTML\u0026#34;, \u0026#34;JSON\u0026#34;] Searching additional fileds To search additional fields defined in front matter, you must add it in 2 places.\nEdit layouts/_default/index.JSON This exposes the values in /index.json i.e. add category\n... \u0026#34;contents\u0026#34;:{{ .Content | plainify | jsonify }} {{ if .Params.tags }}, \u0026#34;tags\u0026#34;:{{ .Params.tags | jsonify }}{{end}}, \u0026#34;categories\u0026#34; : {{ .Params.categories | jsonify }}, ... Edit fuse.js options to Search static/js/search.js\nkeys: [ \u0026#34;title\u0026#34;, \u0026#34;contents\u0026#34;, \u0026#34;tags\u0026#34;, \u0026#34;categories\u0026#34; ] ","permalink":"https://jiyongcheng.dev/search/","tags":null,"title":"Search Results"}]