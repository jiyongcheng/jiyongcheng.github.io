<!doctype html><html lang=en>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<title>Yongcheng website | Postgresql Questions</title>
<meta name=description content>
<meta property="og:image" content="https://jiyongcheng.dev/image/Yongcheng.jpg">
<meta property="og:title" content="Yongcheng website | Postgresql Questions">
<meta property="og:description" content>
<meta name=author content="Aaron Ji">
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css integrity=sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2 crossorigin=anonymous>
<link rel=preload href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,600;0,700;0,800;1,300;1,400;1,600;1,700;1,800&family=Saira+Extra+Condensed:wght@100;200;300;400;500;600;700;800;900&display=swap" as=style onload="this.onload=null,this.rel='stylesheet'">
<noscript><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,600;0,700;0,800;1,300;1,400;1,600;1,700;1,800&family=Saira+Extra+Condensed:wght@100;200;300;400;500;600;700;800;900&display=swap"></noscript>
<link rel=preload href=https://use.fontawesome.com/releases/v5.15.1/css/all.css as=style onload="this.onload=null,this.rel='stylesheet'">
<noscript><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.15.1/css/all.css></noscript>
<link rel=preload href=https://cdnjs.cloudflare.com/ajax/libs/devicons/1.8.0/css/devicons.min.css integrity="sha512-JW3fT0YTK7pT7w437SoX6GcW76jOZ6E0jGmrqBAcloC4GKT+njHOY4fX5KxJ9WfIXTkNrAF994525fAHp+KCxg==" crossorigin=anonymous as=style onload="this.onload=null,this.rel='stylesheet'">
<noscript><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/devicons/1.8.0/css/devicons.min.css integrity="sha512-JW3fT0YTK7pT7w437SoX6GcW76jOZ6E0jGmrqBAcloC4GKT+njHOY4fX5KxJ9WfIXTkNrAF994525fAHp+KCxg==" crossorigin=anonymous></noscript>
<link rel=preload href=https://cdnjs.cloudflare.com/ajax/libs/simple-line-icons/2.5.5/css/simple-line-icons.min.css integrity="sha512-QKC1UZ/ZHNgFzVKSAhV5v5j73eeL9EEN289eKAEFaAjgAiobVAnVv/AGuPbXsKl1dNoel3kNr6PYnSiTzVVBCw==" crossorigin=anonymous as=style onload="this.onload=null,this.rel='stylesheet'">
<noscript><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/simple-line-icons/2.5.5/css/simple-line-icons.min.css integrity="sha512-QKC1UZ/ZHNgFzVKSAhV5v5j73eeL9EEN289eKAEFaAjgAiobVAnVv/AGuPbXsKl1dNoel3kNr6PYnSiTzVVBCw==" crossorigin=anonymous></noscript>
<link rel=preload href=https://jiyongcheng.dev/css/resume.css as=style onload="this.onload=null,this.rel='stylesheet'">
<noscript><link rel=stylesheet href=https://jiyongcheng.dev/css/resume.css></noscript>
<link rel=preload href=https://jiyongcheng.dev/css/tweaks.css as=style onload="this.onload=null,this.rel='stylesheet'">
<noscript><link rel=stylesheet href=https://jiyongcheng.dev/css/tweaks.css></noscript>
<link rel=preload href=https://jiyongcheng.dev/css/resume-override.css as=style onload="this.onload=null,this.rel='stylesheet'">
<noscript><link rel=stylesheet href=https://jiyongcheng.dev/css/resume-override.css></noscript>
<meta name=generator content="Hugo 0.87.0">
</head>
<body id=page-top>
<nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top" id=sideNav>
<a class="navbar-brand js-scroll-trigger" href=#page-top>
<span class="d-block d-lg-none">Aaron Ji</span>
<span class="d-none d-lg-block">
<img class="img-fluid img-profile rounded-circle mx-auto mb-2" src=/image/Yongcheng.jpg alt>
</span>
</a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span>
</button>
<div class="collapse navbar-collapse" id=navbarSupportedContent>
<ul class=navbar-nav>
<li class=nav-item>
<a class="nav-link js-scroll-trigger" href=/#about>About</a>
</li>
<li class=nav-item>
<a class="nav-link js-scroll-trigger" href=/#skills>Skills</a>
</li>
<li class=nav-item>
<a class="nav-link js-scroll-trigger" href=/#projects>Projects</a>
</li>
<li class=nav-item>
<a class="nav-link js-scroll-trigger" href=/#Publications>Publications</a>
</li>
<li class=nav-item>
<a class="nav-link js-scroll-trigger" href=/#experience>Experience</a>
</li>
<li class=nav-item>
<a class="nav-link js-scroll-trigger" href=/#education>Education</a>
</li>
</ul>
</div>
</nav>
<div class="container-fluid p-0">
<p>I try to list out the questions during working on Postgresql here for the future reference.</p>
<h2 id=how-to-convert-date-string-to-timestamp-in-postgresql>How to convert date string to timestamp in postgresql?</h2>
<p>Use function <a href=https://www.postgresqltutorial.com/postgresql-to_timestamp/>TO_TIMESTAMP</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>SELECT</span> TO_TIMESTAMP(<span style=color:#e6db74>&#39;2017-03-31 9:30:20&#39;</span>,<span style=color:#e6db74>&#39;YYYY-MM-DD HH:MI:SS&#39;</span>);
<span style=color:#75715e>-- it will return as following:
</span><span style=color:#75715e></span><span style=color:#ae81ff>2017</span><span style=color:#f92672>-</span><span style=color:#ae81ff>03</span><span style=color:#f92672>-</span><span style=color:#ae81ff>31</span> <span style=color:#ae81ff>09</span>:<span style=color:#ae81ff>30</span>:<span style=color:#ae81ff>20</span>.<span style=color:#ae81ff>000000</span>
</code></pre></div><h2 id=how-to-return-a-string-value-from-jsonb-in-postgresql>How to return a string value from jsonb in Postgresql?</h2>
<p>Use <code>jsonb->>key</code> operator, be carefuly if you use <code>jsonb->key</code> it will return back <code>jsonb</code> type, not a string.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>select</span> <span style=color:#e6db74>&#39;{
</span><span style=color:#e6db74>  &#34;first_name&#34;: &#34;Adam&#34;,
</span><span style=color:#e6db74>  &#34;last_name&#34;: &#34;Smith&#34;,
</span><span style=color:#e6db74>  &#34;created_at&#34;: &#34;2021-12-07 03:08:57&#34;,
</span><span style=color:#e6db74>  &#34;updated_at&#34;: &#34;2021-12-07 03:09:00&#34;
</span><span style=color:#e6db74>}&#39;</span>::jsonb<span style=color:#f92672>-&gt;&gt;</span><span style=color:#e6db74>&#39;first_name&#39;</span>;
<span style=color:#75715e>-- it will return `Adam`
</span></code></pre></div><h2 id=can-i-extract-the-info-from-jsonb-in-postgresql>Can I extract the info from jsonb in postgresql?</h2>
<p><code>jsonb_extract_path ( from_json jsonb, VARIADIC path_elems text[] ) → jsonb</code></p>
<p>Extracts JSON sub-object at the specified path. (This is functionally equivalent to the #> operator, but writing the path out as a variadic list can be more convenient in some cases.)</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql>json_extract_path(<span style=color:#e6db74>&#39;{&#34;f2&#34;:{&#34;f3&#34;:1},&#34;f4&#34;:{&#34;f5&#34;:99,&#34;f6&#34;:&#34;foo&#34;}}&#39;</span>, <span style=color:#e6db74>&#39;f4&#39;</span>, <span style=color:#e6db74>&#39;f6&#39;</span>) <span style=color:#960050;background-color:#1e0010>→</span> <span style=color:#e6db74>&#34;foo&#34;</span>
</code></pre></div><h2 id=how-to-put-log-in-stored-procedures>How to put log in stored procedures?</h2>
<p>You need to change the config file <code>postgresql.conf</code> and set <code>log_min_messages = notice</code>, there are some options you can choose, check the config file.</p>
<h2 id=is-not-null-work-with-composite-type-data>IS NOT NULL work with composite type data</h2>
<p>If you have a value something that is a composite type, for example a row of a table, something <code>IS NOT NULL</code> is only true if none of the attributes of the composite are NULL.
<a href=https://www.postgresonline.com/journal/archives/373-Composite-data-types-why-IS-NOT-NULL-is-not-the-same-as-NOT-IS-NULL.html>check more details here</a></p>
<h2 id=how-to-save-24hours-time-format>How to save 24hours time format</h2>
<p>if you see some error like this <code>Postgresql ERROR: hour "16" is invalid for the 12-hour clock</code>
you could do this <code>TO_TIMESTAMP(i_test_date ->> 'created_at', 'YYYY-MM-DD HH24:MI:SS')</code> to save the time as 24hours format</p>
</div>
<script src=https://code.jquery.com/jquery-3.6.4.slim.min.js integrity="sha256-a2yjHM4jnF9f54xUQakjZGaqYs/V1CYvWpoqZzC2/Bw=" crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js integrity=sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx crossorigin=anonymous></script>
<script src=https://unpkg.com/smoothscroll-polyfill@0.4.4/dist/smoothscroll.min.js integrity=sha384-EYn4rWu1DHvYD0sSSSbMEtXQmMl58CFJd897806+RT1jJVYbhuZlZMN6yG9nCyFa crossorigin=anonymous></script>
<script src=https://unpkg.com/smoothscroll-anchor-polyfill@1.3.2/dist/index.min.js integrity=sha384-EY9NBEHCFbZANmPcTm7CgG8OhsFILy0VBLG85pF6OIpP42NVbZVNsFOc23PYTCkB crossorigin=anonymous></script>
<script async src=/js/resume.js></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=XX-xxxxxx-01"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','XX-xxxxxx-01')</script>
</body>
</html>