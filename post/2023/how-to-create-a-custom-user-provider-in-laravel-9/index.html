<!doctype html><html lang=en>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<title>Yongcheng website | How to create a custom user provider in Laravel 9</title>
<meta name=description content>
<meta property="og:image" content="https://jiyongcheng.dev/image/Yongcheng.jpg">
<meta property="og:title" content="Yongcheng website | How to create a custom user provider in Laravel 9">
<meta property="og:description" content>
<meta name=author content="Aaron Ji">
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css integrity=sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2 crossorigin=anonymous>
<link rel=preload href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,600;0,700;0,800;1,300;1,400;1,600;1,700;1,800&family=Saira+Extra+Condensed:wght@100;200;300;400;500;600;700;800;900&display=swap" as=style onload="this.onload=null,this.rel='stylesheet'">
<noscript><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,600;0,700;0,800;1,300;1,400;1,600;1,700;1,800&family=Saira+Extra+Condensed:wght@100;200;300;400;500;600;700;800;900&display=swap"></noscript>
<link rel=preload href=https://use.fontawesome.com/releases/v5.15.1/css/all.css as=style onload="this.onload=null,this.rel='stylesheet'">
<noscript><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.15.1/css/all.css></noscript>
<link rel=preload href=https://cdnjs.cloudflare.com/ajax/libs/devicons/1.8.0/css/devicons.min.css integrity="sha512-JW3fT0YTK7pT7w437SoX6GcW76jOZ6E0jGmrqBAcloC4GKT+njHOY4fX5KxJ9WfIXTkNrAF994525fAHp+KCxg==" crossorigin=anonymous as=style onload="this.onload=null,this.rel='stylesheet'">
<noscript><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/devicons/1.8.0/css/devicons.min.css integrity="sha512-JW3fT0YTK7pT7w437SoX6GcW76jOZ6E0jGmrqBAcloC4GKT+njHOY4fX5KxJ9WfIXTkNrAF994525fAHp+KCxg==" crossorigin=anonymous></noscript>
<link rel=preload href=https://cdnjs.cloudflare.com/ajax/libs/simple-line-icons/2.5.5/css/simple-line-icons.min.css integrity="sha512-QKC1UZ/ZHNgFzVKSAhV5v5j73eeL9EEN289eKAEFaAjgAiobVAnVv/AGuPbXsKl1dNoel3kNr6PYnSiTzVVBCw==" crossorigin=anonymous as=style onload="this.onload=null,this.rel='stylesheet'">
<noscript><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/simple-line-icons/2.5.5/css/simple-line-icons.min.css integrity="sha512-QKC1UZ/ZHNgFzVKSAhV5v5j73eeL9EEN289eKAEFaAjgAiobVAnVv/AGuPbXsKl1dNoel3kNr6PYnSiTzVVBCw==" crossorigin=anonymous></noscript>
<link rel=preload href=https://jiyongcheng.dev/css/resume.css as=style onload="this.onload=null,this.rel='stylesheet'">
<noscript><link rel=stylesheet href=https://jiyongcheng.dev/css/resume.css></noscript>
<link rel=preload href=https://jiyongcheng.dev/css/tweaks.css as=style onload="this.onload=null,this.rel='stylesheet'">
<noscript><link rel=stylesheet href=https://jiyongcheng.dev/css/tweaks.css></noscript>
<link rel=preload href=https://jiyongcheng.dev/css/resume-override.css as=style onload="this.onload=null,this.rel='stylesheet'">
<noscript><link rel=stylesheet href=https://jiyongcheng.dev/css/resume-override.css></noscript>
<meta name=generator content="Hugo 0.87.0">
</head>
<body id=page-top>
<nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top" id=sideNav>
<a class="navbar-brand js-scroll-trigger" href=#page-top>
<span class="d-block d-lg-none">Aaron Ji</span>
<span class="d-none d-lg-block">
<img class="img-fluid img-profile rounded-circle mx-auto mb-2" src=/image/Yongcheng.jpg alt>
</span>
</a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span>
</button>
<div class="collapse navbar-collapse" id=navbarSupportedContent>
<ul class=navbar-nav>
<li class=nav-item>
<a class="nav-link js-scroll-trigger" href=/#about>About</a>
</li>
<li class=nav-item>
<a class="nav-link js-scroll-trigger" href=/#skills>Skills</a>
</li>
<li class=nav-item>
<a class="nav-link js-scroll-trigger" href=/#experience>Experience</a>
</li>
<li class=nav-item>
<a class="nav-link js-scroll-trigger" href=/#education>Education</a>
</li>
</ul>
</div>
</nav>
<div class="container-fluid p-0">
<p>Laravel provides several built-in user providers for authentication, including Eloquent and Database providers. However, sometimes you may want to use a custom data source or storage for user authentication. In such cases, you can create a custom user provider in Laravel.</p>
<p>For my case, our client has already had hash algorithm and function to work, I&rsquo;m thinking how to use Laravel 9 to do same thing.</p>
<p>So in this tutorial, we will walk you through the steps of creating a custom user provider in Laravel.</p>
<h1 id=prerequisites>Prerequisites</h1>
<p>Before we get started, make sure you have the following:</p>
<ul>
<li>Laravel installed on your machine</li>
<li>A database setup for your Laravel application</li>
</ul>
<h1 id=step-1-create-the-user-model>Step 1: Create the User Model</h1>
<p>The first step is to create a User model that extends the <code>Illuminate\Database\Eloquent\Model</code> class and implement the <code>Illuminate\Contracts\Auth\Authenticatable</code> interface. This model will be used to retrieve user information from the database.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>

<span style=color:#66d9ef>namespace</span> <span style=color:#a6e22e>App\Models</span>;

<span style=color:#66d9ef>use</span> <span style=color:#a6e22e>Illuminate\Database\Eloquent\Factories\HasFactory</span>;
<span style=color:#66d9ef>use</span> <span style=color:#a6e22e>Illuminate\Foundation\Auth\User</span> <span style=color:#66d9ef>as</span> <span style=color:#a6e22e>Authenticatable</span>;

<span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Admin</span> <span style=color:#66d9ef>extends</span> <span style=color:#a6e22e>Authenticatable</span>
{
    <span style=color:#66d9ef>use</span> <span style=color:#a6e22e>HasFactory</span>;

    <span style=color:#66d9ef>public</span> $table<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;cms_adminaccount&#39;</span>;
    <span style=color:#66d9ef>protected</span> $primaryKey <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;uid&#39;</span>;
    <span style=color:#66d9ef>public</span> $timestamps <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;

    <span style=color:#66d9ef>public</span> $fillable <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;username&#39;</span>, <span style=color:#e6db74>&#39;email&#39;</span>, <span style=color:#e6db74>&#39;password&#39;</span>];
}

</code></pre></div><h1 id=step-2-create-the-user-provider>Step 2: Create the User Provider</h1>
<p>The next step is to create a custom user provider that will handle user authentication. You can create a user provider using the <code>make:provider</code> Artisan command:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>php artisan make:provider AdminUserProvider

</code></pre></div><p>This command will create a new file called <code>AdminUserProvider.php</code> in the <code>app/Providers</code> directory. Because we want to use Eloquent to fetch user from DB, but just change how it validates the password. So we extend the class <code>EloquentUserProvider</code></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>

<span style=color:#66d9ef>namespace</span> <span style=color:#a6e22e>App\Providers</span>;

<span style=color:#66d9ef>use</span> <span style=color:#a6e22e>Illuminate\Auth\EloquentUserProvider</span>;
<span style=color:#66d9ef>use</span> <span style=color:#a6e22e>Illuminate\Contracts\Auth\Authenticatable</span> <span style=color:#66d9ef>as</span> <span style=color:#a6e22e>UserContract</span>;

<span style=color:#66d9ef>class</span> <span style=color:#a6e22e>AdminUserProvider</span> <span style=color:#66d9ef>extends</span> <span style=color:#a6e22e>EloquentUserProvider</span>
{
    <span style=color:#e6db74>/**
</span><span style=color:#e6db74>     * Validate a user against the given credentials.
</span><span style=color:#e6db74>     *
</span><span style=color:#e6db74>     * @param  \Illuminate\Contracts\Auth\Authenticatable  $user
</span><span style=color:#e6db74>     * @param  array  $credentials
</span><span style=color:#e6db74>     * @return bool
</span><span style=color:#e6db74>     */</span>
    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>validateCredentials</span>(<span style=color:#a6e22e>UserContract</span> $user, <span style=color:#66d9ef>array</span> $credentials)<span style=color:#f92672>:</span> <span style=color:#a6e22e>bool</span>
    {
        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>is_null</span>($plain <span style=color:#f92672>=</span> $credentials[<span style=color:#e6db74>&#39;password&#39;</span>])) {
            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>;
        }

        <span style=color:#66d9ef>return</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>hasher</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>check</span>($plain, $user<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>getAuthPassword</span>(), [<span style=color:#e6db74>&#39;salt&#39;</span> <span style=color:#f92672>=&gt;</span> $user<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>salt</span>]);
    }
}
</code></pre></div><p>The <code>retrieveById</code> method in the parent class should retrieve a user by their unique identifier, which is typically the user ID. But pay attention to some DB design may choose for example <code>uid</code> as the primary key. So then you need to add <code>protected $primaryKey = 'uid';</code> in your <code>User</code> model.</p>
<p>The <code>retrieveByCredentials</code> method in the parent class should retrieve a user by their credentials (e.g., email and password).</p>
<p>The <code>validateCredentials</code> method should validate the user&rsquo;s credentials. This is the methond we want to extend and put in our logic.</p>
<h1 id=step-3-register-the-user-provider>Step 3: Register the User Provider</h1>
<p>After creating the custom user provider, you need to register it with Laravel. To do this, open the <code>config/auth.php</code> file and add your provider to the providers array:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=color:#e6db74>&#39;providers&#39;</span> <span style=color:#f92672>=&gt;</span> [
    <span style=color:#e6db74>&#39;users&#39;</span> <span style=color:#f92672>=&gt;</span> [
        <span style=color:#e6db74>&#39;driver&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;eloquent&#39;</span>,
        <span style=color:#e6db74>&#39;model&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>App\Models\User</span><span style=color:#f92672>::</span><span style=color:#a6e22e>class</span>,
    ],
    <span style=color:#e6db74>&#39;admin_provider&#39;</span> <span style=color:#f92672>=&gt;</span> [
        <span style=color:#e6db74>&#39;driver&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;admin_provider_driver&#39;</span>,
        <span style=color:#e6db74>&#39;model&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>App\Models\Admin</span><span style=color:#f92672>::</span><span style=color:#a6e22e>class</span>,
    ],
],

</code></pre></div><p>In this example, we&rsquo;ve added a new provider named <code>admins</code> and set its driver to <code>admin_driver</code>. The model key specifies the custom user model that we created in Step 1.</p>
<p>Note that you can choose any name for your provider and driver. It&rsquo;s common to name them after your application or the type of user they represent.</p>
<h1 id=step-4-register-the-custom-guard>Step 4: Register the custom guard</h1>
<p>Define your guard in the guards array of the <code>config/auth.php</code> file. We want to use the admin guard to authenticate admin users.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php>    <span style=color:#e6db74>&#39;guards&#39;</span> <span style=color:#f92672>=&gt;</span> [
        <span style=color:#e6db74>&#39;admin&#39;</span> <span style=color:#f92672>=&gt;</span> [
            <span style=color:#e6db74>&#39;driver&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;session&#39;</span>,
            <span style=color:#e6db74>&#39;provider&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;admin_provider&#39;</span>,
        ]
    ],
</code></pre></div><h1 id=step-5-register-custom-provider-in-authserviceprovider>Step 5: Register custom provider in AuthServiceProvider</h1>
<p>In the <code>boot</code> method of the <code>AuthServiceProvider</code>, register the custom user provider using the <code>Auth</code> facade:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>boot</span>()
    {
        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>registerPolicies</span>();

        <span style=color:#75715e>// add custom guard provider
</span><span style=color:#75715e></span>        <span style=color:#a6e22e>Auth</span><span style=color:#f92672>::</span><span style=color:#a6e22e>provider</span>(<span style=color:#e6db74>&#39;admin_provider_driver&#39;</span>, <span style=color:#66d9ef>function</span> ($app, <span style=color:#66d9ef>array</span> $config) {
            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>AdminUserProvider</span>(<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>SimpleHasher</span>(), $config[<span style=color:#e6db74>&#39;model&#39;</span>]);
        });
    }
</code></pre></div><p>This code registers a new user provider named <code>admin_provider_driver</code> that uses the <code>AdminUserProvider</code> class. The second parameter passed to the <code>AdminUserProvider</code> constructor is the user model class, which is defined in the <code>config/auth.php</code> file.</p>
<p>The first parameter passed to the <code>AdminUserProvider</code> constructor is the custom hasher we created for checking user password.</p>
<h1 id=step-6-create-custom-hasher>Step 6: Create custom hasher</h1>
<p>Because we just want to use the custom hasher for admin user, then we put this hasher in the <code>services</code> folder:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>

<span style=color:#66d9ef>namespace</span> <span style=color:#a6e22e>App\Services</span>;

<span style=color:#66d9ef>use</span> <span style=color:#a6e22e>Illuminate\Contracts\Hashing\Hasher</span>;
<span style=color:#66d9ef>use</span> <span style=color:#a6e22e>Illuminate\Hashing\AbstractHasher</span>;

<span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SimpleHasher</span> <span style=color:#66d9ef>extends</span> <span style=color:#a6e22e>AbstractHasher</span> <span style=color:#66d9ef>implements</span> <span style=color:#a6e22e>Hasher</span>
{
    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>make</span>($value, <span style=color:#66d9ef>array</span> $options <span style=color:#f92672>=</span> [])
    {
        $salt <span style=color:#f92672>=</span> <span style=color:#a6e22e>substr</span>(<span style=color:#a6e22e>uniqid</span>(<span style=color:#a6e22e>rand</span>()), <span style=color:#f92672>-</span><span style=color:#ae81ff>6</span>);

        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>md5</span>(<span style=color:#a6e22e>md5</span>($value) <span style=color:#f92672>.</span> $salt);
    }

    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>check</span>($value, $hashedValue, <span style=color:#66d9ef>array</span> $options <span style=color:#f92672>=</span> [])
    {
        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>md5</span>(<span style=color:#a6e22e>md5</span>($value) <span style=color:#f92672>.</span> $options[<span style=color:#e6db74>&#39;salt&#39;</span>] <span style=color:#f92672>??</span> <span style=color:#e6db74>&#39;&#39;</span>) <span style=color:#f92672>===</span> $hashedValue;
    }

    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>needsRehash</span>($hashedValue, <span style=color:#66d9ef>array</span> $options <span style=color:#f92672>=</span> [])
    {
        <span style=color:#75715e>// Your needsRehash implementation here
</span><span style=color:#75715e></span>    }
}
</code></pre></div><p>in our case we need to use extra info in the <code>$options</code> array to check the password, so this is why we extend <code>EloquentUserProvider</code> to have our custom <code>AdminUserProvider</code> which in the <code>validateCredentials</code> function passes the extra info for checking.</p>
<h1 id=step-7-create-admin-authenticate-middleware-to-guard-admin>Step 7: Create admin authenticate middleware to guard admin</h1>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>

<span style=color:#66d9ef>namespace</span> <span style=color:#a6e22e>App\Http\Middleware</span>;

<span style=color:#66d9ef>use</span> <span style=color:#a6e22e>Closure</span>;
<span style=color:#66d9ef>use</span> <span style=color:#a6e22e>Illuminate\Support\Facades\Auth</span>;

<span style=color:#66d9ef>class</span> <span style=color:#a6e22e>AdminAuthenticate</span>
{
    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>handle</span>($request, <span style=color:#a6e22e>Closure</span> $next)
    {
        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>Auth</span><span style=color:#f92672>::</span><span style=color:#a6e22e>guard</span>(<span style=color:#e6db74>&#39;admin&#39;</span>)<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>check</span>()) {
            <span style=color:#66d9ef>return</span> $next($request);
        } <span style=color:#66d9ef>else</span> {
            <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>redirect</span>()<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>route</span>(<span style=color:#e6db74>&#39;admin.login&#39;</span>);
        }
    }
}

</code></pre></div><p>You then need to register this middle in the <code>Kernel.php</code></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>

<span style=color:#66d9ef>namespace</span> <span style=color:#a6e22e>App\Http</span>;

<span style=color:#66d9ef>use</span> <span style=color:#a6e22e>Illuminate\Foundation\Http\Kernel</span> <span style=color:#66d9ef>as</span> <span style=color:#a6e22e>HttpKernel</span>;

<span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Kernel</span> <span style=color:#66d9ef>extends</span> <span style=color:#a6e22e>HttpKernel</span>
{

    <span style=color:#66d9ef>protected</span> $routeMiddleware <span style=color:#f92672>=</span> [
        <span style=color:#e6db74>&#39;admin.auth&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>\App\Http\Middleware\AdminAuthenticate</span><span style=color:#f92672>::</span><span style=color:#a6e22e>class</span>,
    ];
}
</code></pre></div><h1 id=step-8-set-admin-authenticate-middleware-in-the-controller>Step 8: Set admin authenticate middleware in the controller</h1>
<p>You could add <code>admin.auth</code> middleware for this controller or add in the routes for a group of controllers.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>

<span style=color:#66d9ef>namespace</span> <span style=color:#a6e22e>App\Http\Controllers\Admin</span>;

<span style=color:#66d9ef>use</span> <span style=color:#a6e22e>App\Http\Controllers\Controller</span>;
<span style=color:#66d9ef>use</span> <span style=color:#a6e22e>Illuminate\Support\Facades\Auth</span>;
<span style=color:#66d9ef>use</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>view</span>;

<span style=color:#66d9ef>class</span> <span style=color:#a6e22e>HomeController</span> <span style=color:#66d9ef>extends</span> <span style=color:#a6e22e>Controller</span>
{
    <span style=color:#e6db74>/**
</span><span style=color:#e6db74>     * Create a new controller instance.
</span><span style=color:#e6db74>     *
</span><span style=color:#e6db74>     * @return void
</span><span style=color:#e6db74>     */</span>
    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> __construct()
    {
        $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>middleware</span>(<span style=color:#e6db74>&#39;admin.auth&#39;</span>);
    }
}

</code></pre></div><h1 id=step-9-authenticate-admin-user>Step 9: Authenticate admin user</h1>
<p>You can use <code>Auth::guard('admin')->attempt</code> to login admin user now.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>login</span>()
    {
        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>request</span>()<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>method</span>() <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;POST&#39;</span>) {
            <span style=color:#75715e>// validation
</span><span style=color:#75715e></span>
            $credentials <span style=color:#f92672>=</span> <span style=color:#a6e22e>request</span>()<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>only</span>(<span style=color:#e6db74>&#39;username&#39;</span>, <span style=color:#e6db74>&#39;password&#39;</span>);
            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>Auth</span><span style=color:#f92672>::</span><span style=color:#a6e22e>guard</span>(<span style=color:#e6db74>&#39;admin&#39;</span>)<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>attempt</span>($credentials)) {
                <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>redirect</span>()<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>route</span>(<span style=color:#e6db74>&#39;admin.index&#39;</span>);
            } <span style=color:#66d9ef>else</span> {
                <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>redirect</span>()<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>back</span>()<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>withErrors</span>([
                    <span style=color:#e6db74>&#39;email&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;Invalid credentials&#39;</span>,
                ]);
            }
        }

        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>view</span>(<span style=color:#e6db74>&#39;admin.login&#39;</span>);
    }
</code></pre></div><h1 id=conclusion>Conclusion</h1>
<p>Creating a custom user provider in Laravel is a simple process that allows you to customize the way that users are authenticated in your application. By following the steps outlined in this article, you can create a custom user provider that uses a slight different way to validate password.</p>
</div>
<script src=https://code.jquery.com/jquery-3.6.4.slim.min.js integrity="sha256-a2yjHM4jnF9f54xUQakjZGaqYs/V1CYvWpoqZzC2/Bw=" crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js integrity=sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx crossorigin=anonymous></script>
<script src=https://unpkg.com/smoothscroll-polyfill@0.4.4/dist/smoothscroll.min.js integrity=sha384-EYn4rWu1DHvYD0sSSSbMEtXQmMl58CFJd897806+RT1jJVYbhuZlZMN6yG9nCyFa crossorigin=anonymous></script>
<script src=https://unpkg.com/smoothscroll-anchor-polyfill@1.3.2/dist/index.min.js integrity=sha384-EY9NBEHCFbZANmPcTm7CgG8OhsFILy0VBLG85pF6OIpP42NVbZVNsFOc23PYTCkB crossorigin=anonymous></script>
<script async src=/js/resume.js></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=XX-xxxxxx-01"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','XX-xxxxxx-01')</script>
</body>
</html>